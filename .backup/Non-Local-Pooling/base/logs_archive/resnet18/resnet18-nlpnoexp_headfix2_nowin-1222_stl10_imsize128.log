
 Run on time: 2022-07-13 00:05:20.758242

 Architecture: resnet18-nlpnoexp_headfix2_nowin-1222

 Pool Config: {
    "arch": "resnet18",
    "conv1": {
        "_conv2d": "norm",
        "pool_cfg": {
            "_ptype": "skip",
            "_stride": 2,
            "_psize": null,
            "_dim_reduced_ratio": null,
            "_num_heads": null,
            "_conv2d": null,
            "_win_norm": null
        }
    },
    "pool": {
        "_conv2d": null,
        "pool_cfg": {
            "_ptype": "maxp",
            "_stride": 2,
            "_psize": null,
            "_dim_reduced_ratio": null,
            "_num_heads": null,
            "_conv2d": null,
            "_win_norm": null
        }
    },
    "layer1": {
        "_conv2d": "norm",
        "pool_cfg": {
            "_ptype": "skip",
            "_stride": 1,
            "_psize": null,
            "_dim_reduced_ratio": null,
            "_num_heads": 2,
            "_conv2d": null,
            "_win_norm": false
        }
    },
    "layer2": {
        "_conv2d": "norm",
        "pool_cfg": {
            "_ptype": "nlpnoexp",
            "_stride": 2,
            "_psize": 1,
            "_dim_reduced_ratio": 1,
            "_num_heads": 2,
            "_conv2d": "norm",
            "_win_norm": false
        }
    },
    "layer3": {
        "_conv2d": "norm",
        "pool_cfg": {
            "_ptype": "nlpnoexp",
            "_stride": 2,
            "_psize": 1,
            "_dim_reduced_ratio": 1,
            "_num_heads": 2,
            "_conv2d": "norm",
            "_win_norm": false
        }
    },
    "layer4": {
        "_conv2d": "norm",
        "pool_cfg": {
            "_ptype": "nlpnoexp",
            "_stride": 2,
            "_psize": 1,
            "_dim_reduced_ratio": 1,
            "_num_heads": 2,
            "_conv2d": "norm",
            "_win_norm": false
        }
    }
}

 Arguments:
	 gpu                  : True
	 log                  : True
	 seed                 : 0
	 momentum             : 0.9
	 amsgrad              : True
	 dataset              : STL10
	 batch_size           : 8
	 architecture         : resnet18-nlpnoexp_headfix2_nowin-1222
	 im_size              : 128
	 relu_threshold       : 4.0
	 learning_rate        : 0.01
	 pretrained_backbone  : 
	 pretrained_ann       : 
	 weight_decay         : 0.0
	 test_only            : False
	 epochs               : 300
	 lr_interval          : [180, 240, 270]
	 lr_reduce            : 5
	 optimizer            : SGD
	 dropout              : 0.2
	 kernel_size          : 3
	 dont_save            : False
	 visualize            : False
	 devices              : 0
 DataParallel(
  (module): Network(
    (net): ResNet(
      (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
      (layer1): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (1): BasicBlock(
          (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (layer2): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (downsample): Sequential(
            (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
            (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicBlock(
          (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (pool): Pool2d(
          (logit): Sequential(
            (pool_weight): NLP_BASE(
              (downsample): Sequential(
                (0): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1))
                (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                (2): ReLU(inplace=True)
              )
              (multihead_attn): MultiheadAttention(
                (out_proj): NonDynamicallyQuantizableLinear(in_features=128, out_features=128, bias=True)
              )
              (restore): Sequential(
                (0): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1))
                (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                (2): Sigmoid()
              )
              (pos_embed): PositionEmbeddingLearned(
                (row_embed): Embedding(256, 64)
                (col_embed): Embedding(256, 64)
              )
            )
          )
          (pool): AvgPool2d(kernel_size=2, stride=2, padding=0)
        )
      )
      (layer3): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (downsample): Sequential(
            (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
            (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicBlock(
          (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (pool): Pool2d(
          (logit): Sequential(
            (pool_weight): NLP_BASE(
              (downsample): Sequential(
                (0): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1))
                (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                (2): ReLU(inplace=True)
              )
              (multihead_attn): MultiheadAttention(
                (out_proj): NonDynamicallyQuantizableLinear(in_features=256, out_features=256, bias=True)
              )
              (restore): Sequential(
                (0): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1))
                (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                (2): Sigmoid()
              )
              (pos_embed): PositionEmbeddingLearned(
                (row_embed): Embedding(256, 128)
                (col_embed): Embedding(256, 128)
              )
            )
          )
          (pool): AvgPool2d(kernel_size=2, stride=2, padding=0)
        )
      )
      (layer4): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (downsample): Sequential(
            (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
            (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicBlock(
          (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (pool): Pool2d(
          (logit): Sequential(
            (pool_weight): NLP_BASE(
              (downsample): Sequential(
                (0): Conv2d(512, 512, kernel_size=(1, 1), stride=(1, 1))
                (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                (2): ReLU(inplace=True)
              )
              (multihead_attn): MultiheadAttention(
                (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
              )
              (restore): Sequential(
                (0): Conv2d(512, 512, kernel_size=(1, 1), stride=(1, 1))
                (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                (2): Sigmoid()
              )
              (pos_embed): PositionEmbeddingLearned(
                (row_embed): Embedding(256, 256)
                (col_embed): Embedding(256, 256)
              )
            )
          )
          (pool): AvgPool2d(kernel_size=2, stride=2, padding=0)
        )
      )
      (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
      (fc): Linear(in_features=512, out_features=10, bias=True)
    )
  )
)
 SGD (
Parameter Group 0
    dampening: 0
    lr: 0.01
    momentum: 0.9
    nesterov: False
    weight_decay: 0.0
)
 Epoch: 1, lr: 1.0e-02, train_loss: 2.1165, train_acc: 0.2074 test_loss: 1.9390, test_acc: 0.2672, best: 0.2672, time: 0:01:04
 Epoch: 2, lr: 1.0e-02, train_loss: 1.9383, train_acc: 0.2466 test_loss: 1.8218, test_acc: 0.2681, best: 0.2681, time: 0:01:03
 Epoch: 3, lr: 1.0e-02, train_loss: 1.8510, train_acc: 0.2898 test_loss: 1.6504, test_acc: 0.3516, best: 0.3516, time: 0:01:05
 Epoch: 4, lr: 1.0e-02, train_loss: 1.7926, train_acc: 0.3164 test_loss: 1.7338, test_acc: 0.3399, best: 0.3516, time: 0:01:04
 Epoch: 5, lr: 1.0e-02, train_loss: 1.7303, train_acc: 0.3442 test_loss: 1.5083, test_acc: 0.4158, best: 0.4158, time: 0:01:05
 Epoch: 6, lr: 1.0e-02, train_loss: 1.6556, train_acc: 0.3884 test_loss: 1.5179, test_acc: 0.4450, best: 0.4450, time: 0:01:05
 Epoch: 7, lr: 1.0e-02, train_loss: 1.5971, train_acc: 0.3918 test_loss: 1.4349, test_acc: 0.4587, best: 0.4587, time: 0:01:05
 Epoch: 8, lr: 1.0e-02, train_loss: 1.5532, train_acc: 0.4178 test_loss: 1.3736, test_acc: 0.4871, best: 0.4871, time: 0:01:05
 Epoch: 9, lr: 1.0e-02, train_loss: 1.5075, train_acc: 0.4412 test_loss: 1.3402, test_acc: 0.5020, best: 0.5020, time: 0:01:05
 Epoch: 10, lr: 1.0e-02, train_loss: 1.4796, train_acc: 0.4544 test_loss: 1.2963, test_acc: 0.5285, best: 0.5285, time: 0:01:05
 Epoch: 11, lr: 1.0e-02, train_loss: 1.4122, train_acc: 0.4774 test_loss: 1.3610, test_acc: 0.4920, best: 0.5285, time: 0:01:05
 Epoch: 12, lr: 1.0e-02, train_loss: 1.3868, train_acc: 0.4886 test_loss: 1.2063, test_acc: 0.5586, best: 0.5586, time: 0:01:05
 Epoch: 13, lr: 1.0e-02, train_loss: 1.3437, train_acc: 0.5030 test_loss: 1.1289, test_acc: 0.5850, best: 0.5850, time: 0:01:05
 Epoch: 14, lr: 1.0e-02, train_loss: 1.3201, train_acc: 0.5240 test_loss: 1.1808, test_acc: 0.5713, best: 0.5850, time: 0:01:05
 Epoch: 15, lr: 1.0e-02, train_loss: 1.2935, train_acc: 0.5392 test_loss: 1.1662, test_acc: 0.5756, best: 0.5850, time: 0:01:05
 Epoch: 16, lr: 1.0e-02, train_loss: 1.2644, train_acc: 0.5416 test_loss: 1.1062, test_acc: 0.6029, best: 0.6029, time: 0:01:05
 Epoch: 17, lr: 1.0e-02, train_loss: 1.2299, train_acc: 0.5484 test_loss: 1.0636, test_acc: 0.6211, best: 0.6211, time: 0:01:05
 Epoch: 18, lr: 1.0e-02, train_loss: 1.2178, train_acc: 0.5526 test_loss: 1.1797, test_acc: 0.5849, best: 0.6211, time: 0:01:05
 Epoch: 19, lr: 1.0e-02, train_loss: 1.2050, train_acc: 0.5670 test_loss: 1.1433, test_acc: 0.5924, best: 0.6211, time: 0:01:05
 Epoch: 20, lr: 1.0e-02, train_loss: 1.1785, train_acc: 0.5772 test_loss: 1.0804, test_acc: 0.6235, best: 0.6235, time: 0:01:05
 Epoch: 21, lr: 1.0e-02, train_loss: 1.1333, train_acc: 0.5874 test_loss: 1.2074, test_acc: 0.5761, best: 0.6235, time: 0:01:05
 Epoch: 22, lr: 1.0e-02, train_loss: 1.1338, train_acc: 0.5954 test_loss: 1.0425, test_acc: 0.6175, best: 0.6235, time: 0:01:05
 Epoch: 23, lr: 1.0e-02, train_loss: 1.1038, train_acc: 0.6008 test_loss: 1.0942, test_acc: 0.6068, best: 0.6235, time: 0:01:05
 Epoch: 24, lr: 1.0e-02, train_loss: 1.0836, train_acc: 0.6154 test_loss: 1.0066, test_acc: 0.6436, best: 0.6436, time: 0:01:05
 Epoch: 25, lr: 1.0e-02, train_loss: 1.0690, train_acc: 0.6142 test_loss: 0.9534, test_acc: 0.6546, best: 0.6546, time: 0:01:05
 Epoch: 26, lr: 1.0e-02, train_loss: 1.0620, train_acc: 0.6144 test_loss: 0.9054, test_acc: 0.6694, best: 0.6694, time: 0:01:05
 Epoch: 27, lr: 1.0e-02, train_loss: 1.0299, train_acc: 0.6222 test_loss: 0.9212, test_acc: 0.6753, best: 0.6753, time: 0:01:05
 Epoch: 28, lr: 1.0e-02, train_loss: 1.0241, train_acc: 0.6220 test_loss: 0.9300, test_acc: 0.6790, best: 0.6790, time: 0:01:05
 Epoch: 29, lr: 1.0e-02, train_loss: 0.9916, train_acc: 0.6440 test_loss: 0.8844, test_acc: 0.6869, best: 0.6869, time: 0:01:05
 Epoch: 30, lr: 1.0e-02, train_loss: 0.9770, train_acc: 0.6438 test_loss: 0.9655, test_acc: 0.6643, best: 0.6869, time: 0:01:05
 Epoch: 31, lr: 1.0e-02, train_loss: 0.9828, train_acc: 0.6476 test_loss: 0.9715, test_acc: 0.6705, best: 0.6869, time: 0:01:05
 Epoch: 32, lr: 1.0e-02, train_loss: 0.9821, train_acc: 0.6500 test_loss: 0.9315, test_acc: 0.6769, best: 0.6869, time: 0:01:05
 Epoch: 33, lr: 1.0e-02, train_loss: 0.9192, train_acc: 0.6742 test_loss: 1.0227, test_acc: 0.6630, best: 0.6869, time: 0:01:05
 Epoch: 34, lr: 1.0e-02, train_loss: 0.9212, train_acc: 0.6694